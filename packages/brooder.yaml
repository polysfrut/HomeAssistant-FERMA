# ----------------------------------------------------------------------
# –ü—Ä–æ–µ–∫—Ç: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–ø–µ–ª–∏–Ω–æ–π —Ñ–µ—Ä–º—ã (–±—Ä—É–¥–µ—Ä) –Ω–∞ Home Assistant
# –ü—Ä–æ—Ç–æ–∫–æ–ª: Modbus RTU (RS485) + WaveShare —Ä–µ–ª–µ/–¥–∞—Ç—á–∏–∫–∏
# –ê–≤—Ç–æ—Ä: dmk2025 (xAI) ‚Äì —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# ----------------------------------------------------------------------
# 1. –í–•–û–î–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ (input_number) ‚Äì –º–µ–Ω—è—é—Ç—Å—è –≤ UI
# 2. –ö–ù–û–ü–ö–ò (input_button)
# 3. –°–¢–ê–¢–£–°–´ (input_text + sensor)
# 4. –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò (automation) ‚Äì –≤–µ—Å—å –∞–ª–≥–æ—Ä–∏—Ç–º
# ----------------------------------------------------------------------
# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
#   ‚Ä¢ modbus: —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (hub "waveshare001")
#   ‚Ä¢ notify: –ª—é–±–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, mobile_app –∏–ª–∏ telegram)
#   ‚Ä¢ shell_command: –Ω–µ—Ç
# ----------------------------------------------------------------------
# ----------------------------------------------------------------------
# –î–û–ü–û–õ–ù–ï–ù–ò–ï: –õ–æ–≥–∏–∫–∞ –ê–í–ê–†–ò–ô–ù–û–ì–û –û–°–¢–ê–ù–û–í–ê
# –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π configuration.yaml (–∏–ª–∏ package)
# ----------------------------------------------------------------------
# –ß—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è "–∞–≤–∞—Ä–∏–µ–π":
# 1. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > –ú–∞–∫—Å –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—Ä—É–¥–µ—Ä–∞ + 3¬∞C (–ø–µ—Ä–µ–≥—Ä–µ–≤)
# 2. –í–ª–∞–∂–Ω–æ—Å—Ç—å > –ú–∞–∫—Å –≤–ª–∞–∂–Ω–æ—Å—Ç—å –±—Ä—É–¥–µ—Ä–∞ + 10% (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å)
# 3. –î–∞—Ç—á–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã > 5 –º–∏–Ω—É—Ç (unavailable)
# 4. –ê–≤–∞—Ä–∏–π–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (—É–∂–µ –µ—Å—Ç—å: binary_sensor.waveshare001_di8)
#
# –ü—Ä–∏ –∞–≤–∞—Ä–∏–∏:
#   ‚Ä¢ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –í–°–ï–ì–û –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
#   ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ –±—Ä—É–¥–µ—Ä–∞ ‚Üí "–ê–í–ê–†–ò–Ø"
#   ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π
#   ‚Ä¢ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—É—Å–∫–∞ –¥–æ —Ä—É—á–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ (–∫–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å –∞–≤–∞—Ä–∏–∏")
# ----------------------------------------------------------------------


# ======================================================================
# 1. INPUT_NUMBER ‚Äì –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (UI)
# ======================================================================
input_number:
  ir_time_56:                     # "–í—Ä–µ–º—è –ò–ö –ª–∞–º–ø—ã 5-6" (–¥–Ω–µ–π)
    name: –í—Ä–µ–º—è –ò–ö –ª–∞–º–ø—ã 5-6
    min: 1
    max: 10
    initial: 7
    step: 1
    unit_of_measurement: –¥–Ω–µ–π
    icon: mdi:timer

  ir_time_34:                     # "–í—Ä–µ–º—è –ò–ö –ª–∞–º–ø—ã 3-4" (–¥–Ω–µ–π)
    name: –í—Ä–µ–º—è –ò–ö –ª–∞–º–ø—ã 3-4
    min: 1
    max: 10
    initial: 2
    step: 1
    unit_of_measurement: –¥–Ω–µ–π
    icon: mdi:timer

  ir_time_12:                     # "–í—Ä–µ–º—è –ò–ö –ª–∞–º–ø—ã 1-2" (–¥–Ω–µ–π)
    name: –í—Ä–µ–º—è –ò–ö –ª–∞–º–ø—ã 1-2
    min: 1
    max: 10
    initial: 1
    step: 1
    unit_of_measurement: –¥–Ω–µ–π
    icon: mdi:timer

  work_cycle:                     # "–†–∞–±–æ—á–∏–π —Ü–∏–∫–ª" (–¥–Ω–µ–π)
    name: –†–∞–±–æ—á–∏–π —Ü–∏–∫–ª
    min: 1
    max: 15
    initial: 14
    step: 1
    unit_of_measurement: –¥–Ω–µ–π
    icon: mdi:calendar-clock

  min_temp:                       # "–ú–∏–Ω –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—Ä—É–¥–µ—Ä–∞"
    name: –ú–∏–Ω –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—Ä—É–¥–µ—Ä–∞
    min: 20
    max: 40
    initial: 30
    step: 0.5
    unit_of_measurement: ¬∞C
    icon: mdi:thermometer-low

  max_temp:                       # "–ú–∞–∫—Å –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—Ä—É–¥–µ—Ä–∞"
    name: –ú–∞–∫—Å –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—Ä—É–¥–µ—Ä–∞
    min: 20
    max: 40
    initial: 37
    step: 0.5
    unit_of_measurement: ¬∞C
    icon: mdi:thermometer-high

  min_hum:                        # "–ú–∏–Ω –≤–ª–∞–∂–Ω–æ—Å—Ç—å –±—Ä—É–¥–µ—Ä–∞"
    name: –ú–∏–Ω –≤–ª–∞–∂–Ω–æ—Å—Ç—å –±—Ä—É–¥–µ—Ä–∞
    min: 40
    max: 70
    initial: 60
    step: 1
    unit_of_measurement: '%'
    icon: mdi:water-percent

  max_hum:                        # "–ú–∞–∫—Å –≤–ª–∞–∂–Ω–æ—Å—Ç—å –±—Ä—É–¥–µ—Ä–∞"
    name: –ú–∞–∫—Å –≤–ª–∞–∂–Ω–æ—Å—Ç—å –±—Ä—É–¥–µ—Ä–∞
    min: 40
    max: 70
    initial: 65
    step: 1
    unit_of_measurement: '%'
    icon: mdi:water-percent

  dehum_min_temp:                 # "–ú–∏–Ω —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –æ—Å—É—à–µ–Ω–∏—è"
    name: –ú–∏–Ω —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –æ—Å—É—à–µ–Ω–∏—è
    min: 25
    max: 35
    initial: 31
    step: 0.5
    unit_of_measurement: ¬∞C
    icon: mdi:thermometer

  fan_min_on:                     # "–ú–∏–Ω –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞"
    name: –ú–∏–Ω –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
    min: 1
    max: 10
    initial: 3
    step: 1
    unit_of_measurement: –º–∏–Ω
    icon: mdi:timer

  temp_fan_hysteresis:            # "–ì–∏—Å—Ç–µ—Ä–µ–∑–∏—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (–≤–æ–∑–≤—Ä–∞—Ç –æ—Ç max_temp)"
    name: –ì–∏—Å—Ç–µ—Ä–µ–∑–∏—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
    min: 0.1
    max: 2.0
    initial: 0.6
    step: 0.1
    unit_of_measurement: ¬∞C
    icon: mdi:thermometer


# ======================================================================
# 2. INPUT_BUTTON ‚Äì –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
# ======================================================================
input_button:
  start_brooder:                  # "–ó–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä—É–¥–µ—Ä"
    name: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä—É–¥–µ—Ä
    icon: mdi:play-circle

  preheat:                        # "–ü—Ä–æ–≥—Ä–µ–≤"
    name: –ü—Ä–æ–≥—Ä–µ–≤
    icon: mdi:heat-wave

  lighting:                       # "–û—Å–≤–µ—â–µ–Ω–∏–µ"
    name: –û—Å–≤–µ—â–µ–Ω–∏–µ
    icon: mdi:lightbulb-on

  ir_lamps:                       # "–ò–ö –ª–∞–º–ø—ã"
    name: –ò–ö –ª–∞–º–ø—ã
    icon: mdi:lightbulb-outline

  stop_brooder:                   # "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—Ä—É–¥–µ—Ä"
    name: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—Ä—É–¥–µ—Ä
    icon: mdi:stop-circle

# –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ –∞–≤–∞—Ä–∏–∏ (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è)
  reset_emergency:
    name: –°–±—Ä–æ—Å –∞–≤–∞—Ä–∏–∏
    icon: mdi:restore-alert

# –°—Ç–∞—Ç—É—Å –∞–≤–∞—Ä–∏–∏ (–¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
input_boolean:
  emergency_active:
    name: –ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω
    initial: off
    icon: mdi:alert

  ruchnoi_rezhim:
    name: –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º
    initial: off
    icon: mdi:hand-back-left

# ======================================================================
# 3. INPUT_TEXT / INPUT_DATETIME ‚Äì —Å—Ç–∞—Ç—É—Å—ã –∏ —Ç–∞–π–º–µ—Ä—ã
# ======================================================================
input_text:
  brooder_state:                  # "–°–æ—Å—Ç–æ—è–Ω–∏–µ –±—Ä—É–¥–µ—Ä–∞"
    
  emergency_reason:               # "–ü—Ä–∏—á–∏–Ω–∞ –∞–≤–∞—Ä–∏–∏"
    name: –ü—Ä–∏—á–∏–Ω–∞ –∞–≤–∞—Ä–∏–∏
    initial: ""
    max: 100
    name: –°–æ—Å—Ç–æ—è–Ω–∏–µ –±—Ä—É–¥–µ—Ä–∞
    initial: –û–∂–∏–¥–∞–Ω–∏–µ
    icon: mdi:information-outline

input_datetime:
  init_time:                      # –î–∞—Ç–∞/–≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"
    name: –í—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    has_date: true
    has_time: true

  ir_on_time:                     # –î–∞—Ç–∞/–≤—Ä–µ–º—è –≤–∫–ª—é—á–µ–Ω–∏—è –ò–ö –ª–∞–º–ø
    name: –ò–ö –ª–∞–º–ø—ã –≤–∫–ª—é—á–µ–Ω—ã
    has_date: true
    has_time: true

  ir_off_56:                      # –ü–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ò–ö 5-6
    name: –û—Ç–∫–ª. –ò–ö 5-6
    has_date: true
    has_time: true

  ir_off_34:                      # –ü–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ò–ö 3-4
    name: –û—Ç–∫–ª. –ò–ö 3-4
    has_date: true
    has_time: true

  ir_off_12:                      # –ü–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ò–ö 1-2
    name: –û—Ç–∫–ª. –ò–ö 1-2
    has_date: true
    has_time: true

  lighting_start:                 # "–û—Å–≤–µ—â–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ"
    name: –û—Å–≤–µ—â–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
    has_date: true
    has_time: true

  ten1_start_temp:                # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –¢–≠–ù1
    name: –¢–≠–ù1 —Å—Ç–∞—Ä—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
    has_date: false
    has_time: true

  ten1_start_time:                # –í—Ä–µ–º—è –≤–∫–ª—é—á–µ–Ω–∏—è –¢–≠–ù1
    name: –¢–≠–ù1 —Å—Ç–∞—Ä—Ç –≤—Ä–µ–º—è
    has_date: true
    has_time: true

  fan_start_time:                 # –í—Ä–µ–º—è –≤–∫–ª—é—á–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
    name: –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä —Å—Ç–∞—Ä—Ç –≤—Ä–µ–º—è
    has_date: true
    has_time: true

  fan_stop_time:                  # –í—Ä–µ–º—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
    name: –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä —Å—Ç–æ–ø –≤—Ä–µ–º—è
    has_date: true
    has_time: true

  fan_reason:                     # –ü—Ä–∏—á–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (humidity –∏–ª–∏ temperature)
    name: –ü—Ä–∏—á–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
    initial: ""
    max: 20

  fan_reason:                     # –ü—Ä–∏—á–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (humidity –∏–ª–∏ temperature)
    name: –ü—Ä–∏—á–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞
    initial: ""
    max: 20


# ======================================================================
# 4. TEMPLATE SENSORS ‚Äì –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)
# ======================================================================
template:
  - sensor:
      - name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—Ä—É–¥–µ—Ä–∞"
        unit_of_measurement: ¬∞C
        state: "{{ states('sensor.waveshare001_rs485_temperature_10') }}"

      - name: "–í–ª–∞–∂–Ω–æ—Å—Ç—å –±—Ä—É–¥–µ—Ä–∞"
        unit_of_measurement: '%'
        state: >
          {% set h = states('sensor.waveshare001_rs485_humidity_10')|float(0) %}
          {{ "%.1f"|format(h|round(1)) }}

      - name: "–í—Å–µ –ò–ö –ª–∞–º–ø—ã –≤—ã–∫–ª—é—á–µ–Ω—ã"
        state: >
          {% if is_state('switch.waveshare001_relay_5', 'off') and
                is_state('switch.waveshare001_relay_6', 'off') and
                is_state('switch.waveshare001_relay_7', 'off') %}
            true
          {% else %}
            false
          {% endif %}


# ======================================================================
# 5. –£–¢–ò–õ–ò–¢–´ ‚Äì —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
# ======================================================================
# –ó–∞–º–µ–Ω–∏—Ç–µ "notify.mobile_app_your_phone" –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π notifier
notify:
    platform: telegram
    chat_id: -4042989566
    name: brooder_notify

script:
  send_notify:
    sequence:
      - service: notify.brooder_notify
        data:
          message: >-
            –ë—Ä—É–¥–µ—Ä 1. {{ message }} –î–∞—Ç–∞ {{ now().strftime('%d.%m.%Y %H:%M') }}.
            T={{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C,
            H={{ states('sensor.waveshare001_rs485_humidity_10') }}%.

# ======================================================================
# SCRIPT: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—Ä—É–¥–µ—Ä–∞ (–æ–±—â–∏–π)
# ======================================================================
  stop_brooder:
    sequence:
      - service: script.send_notify
        data:
          message: "–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
      - service: input_text.set_value
        data:
          entity_id: input_text.brooder_state
          value: –û–∂–∏–¥–∞–Ω–∏–µ
      - service: switch.turn_off
        target:
          entity_id:
            - switch.waveshare001_relay_8   # –û—Å–≤–µ—â–µ–Ω–∏–µ
            - switch.waveshare001_relay_5   # –ò–ö 1-2
            - switch.waveshare001_relay_6   # –ò–ö 3-4
            - switch.waveshare001_relay_7   # –ò–ö 5-6
            - switch.waveshare001_relay_1   # –¢–≠–ù1
            - switch.waveshare001_relay_2   # –¢–≠–ù2
            - switch.waveshare001_relay_3   # –í–µ–Ω—Ç.1
            - switch.waveshare001_relay_4   # –í–µ–Ω—Ç.2

# ======================================================================
# –°–ö–†–ò–ü–¢: –ü–æ–ª–Ω–∞—è –∞–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
# ======================================================================
  emergency_stop:
    sequence:
      # 1. –û—Ç–∫–ª—é—á–∞–µ–º –í–°–Å
      - service: switch.turn_off
        target:
          entity_id:
            - switch.waveshare001_relay_1   # –¢–≠–ù1
            - switch.waveshare001_relay_2   # –¢–≠–ù2
            - switch.waveshare001_relay_5   # –ò–ö 1-2
            - switch.waveshare001_relay_6   # –ò–ö 3-4
            - switch.waveshare001_relay_7   # –ò–ö 5-6
            - switch.waveshare001_relay_8   # –û—Å–≤–µ—â–µ–Ω–∏–µ
            - switch.waveshare001_relay_3   # –í–µ–Ω—Ç.1
            - switch.waveshare001_relay_4   # –í–µ–Ω—Ç.2

      # 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
      - service: input_text.set_value
        data:
          entity_id: input_text.brooder_state
          value: –ê–í–ê–†–ò–Ø

      # 3. –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ñ–ª–∞–≥ –∞–≤–∞—Ä–∏–∏
      - service: input_boolean.turn_on
        target:
          entity_id: input_boolean.emergency_active

      # 4. –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏—á–∏–Ω—É –∞–≤–∞—Ä–∏–∏
      - service: input_text.set_value
        data:
          entity_id: input_text.emergency_reason
          value: "{{ reason }}"

      # 5. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π (–ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é)
      - service: notify.brooder_notify
        data:
          message: >-
            üö® –ê–í–ê–†–ò–Ø! –ë—Ä—É–¥–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü—Ä–∏—á–∏–Ω–∞: {{ reason }}
            T={{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C,
            H={{ states('sensor.waveshare001_rs485_humidity_10') }}%.
            –í—Ä–µ–º—è: {{ now().strftime('%d.%m.%Y %H:%M') }}

            
# ======================================================================
# 6. –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò
# ======================================================================
automation:

  # -------------------------------------------------
  # 1. –ö–ù–û–ü–ö–ê "–ü—Ä–æ–≥—Ä–µ–≤" ‚Üí –í–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ò–ö –ª–∞–º–ø –∏ –≤—Å–µ—Ö –¢–≠–ù–æ–≤
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ö–Ω–æ–ø–∫–∞ –ü—Ä–æ–≥—Ä–µ–≤ ‚Üí –í–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ò–ö –ª–∞–º–ø –∏ –≤—Å–µ—Ö –¢–≠–ù–æ–≤"
    trigger:
      - platform: state
        entity_id: input_button.preheat
    condition:
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "off"
    action:
      # 1.1 –û—Ç–∫–ª—é—á–∏—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ –∏ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ã
      - service: switch.turn_off
        target:
          entity_id:
            - switch.waveshare001_relay_8   # –û—Å–≤–µ—â–µ–Ω–∏–µ
            - switch.waveshare001_relay_3   # –í–µ–Ω—Ç.—Å–∫–æ—Ä.1
            - switch.waveshare001_relay_4   # –í–µ–Ω—Ç.—Å–∫–æ—Ä.2
      
      # 1.2 –í–∫–ª—é—á–∏—Ç—å –≤—Å–µ –ò–ö –ª–∞–º–ø—ã
      - service: switch.turn_on
        target:
          entity_id:
            - switch.waveshare001_relay_5   # –ò–ö 1-2
            - switch.waveshare001_relay_6   # –ò–ö 3-4
            - switch.waveshare001_relay_7   # –ò–ö 5-6
      
      # 1.3 –í–∫–ª—é—á–∏—Ç—å –¢–≠–ù1 –∏ –¢–≠–ù2
      - service: switch.turn_on
        target:
          entity_id:
            - switch.waveshare001_relay_1   # –¢–≠–ù1
            - switch.waveshare001_relay_2   # –¢–≠–ù2
      
      # 1.4 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ "–ü–æ–¥–æ–≥—Ä–µ–≤"
      - service: input_text.set_value
        data:
          entity_id: input_text.brooder_state
          value: –ü–æ–¥–æ–≥—Ä–µ–≤
      
      # 1.5 –ó–∞–ø–æ–º–Ω–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≥—Ä–µ–≤–∞
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.ten1_start_time
          timestamp: "{{ now().timestamp() | int }}"
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.ten1_start_temp
          timestamp: "{{ states('sensor.waveshare001_rs485_temperature_10')|float }}"
      
      # 1.6 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      - service: script.send_notify
        data:
          message: "–ü—Ä–æ–≥—Ä–µ–≤ –∑–∞–ø—É—â–µ–Ω. –í–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –ò–ö –ª–∞–º–ø—ã –∏ –¢–≠–ù—ã. –¢–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C, —Ü–µ–ª—å {{ states('input_number.min_temp') }}¬∞C."

  # -------------------------------------------------
  # 1.2 –ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ (–ø—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ)
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ"
    trigger:
      - platform: state
        entity_id: input_text.brooder_state
        to: "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ"
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_humidity_10
        above: input_number.min_hum
    condition:
      - condition: state
        entity_id: input_text.brooder_state
        state: "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ"
    action:
      - choose:
          # –ï—Å–ª–∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å > min ‚Üí –≤–∫–ª—é—á–∞–µ–º –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä
          - conditions:
              - condition: numeric_state
                entity_id: sensor.waveshare001_rs485_humidity_10
                above: input_number.min_hum
            sequence:
              - service: switch.turn_on
                target:
                  entity_id: switch.waveshare001_relay_3   # –í–µ–Ω—Ç.—Å–∫–æ—Ä.1
              - service: script.send_notify
                data:
                  message: "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ: –≤–ª–∞–∂–Ω–æ—Å—Ç—å > {{ states('input_number.min_hum') }}%, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤–∫–ª—é—á—ë–Ω."
          # –ö–æ–≥–¥–∞ –≤–ª–∞–∂–Ω–æ—Å—Ç—å < min ‚Üí 15 –º–∏–Ω —Ç–∞–π–º–µ—Ä
          - conditions:
              - condition: numeric_state
                entity_id: sensor.waveshare001_rs485_humidity_10
                below: input_number.min_hum
            sequence:
              - service: switch.turn_on
                target:
                  entity_id: switch.waveshare001_relay_3
              - delay: "00:15:00"
              - service: switch.turn_off
                target:
                  entity_id: switch.waveshare001_relay_3
              - service: input_text.set_value
                data:
                  entity_id: input_text.brooder_state
                  value: –ü–æ–¥–æ–≥—Ä–µ–≤
              - service: script.send_notify
                data:
                  message: "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø–æ–¥–æ–≥—Ä–µ–≤—É."

  # -------------------------------------------------
  # 1.3 –ü–æ–¥–æ–≥—Ä–µ–≤ (–¢–≠–ù—ã + –ò–ö)
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ü–æ–¥–æ–≥—Ä–µ–≤ ‚Äì –¢–≠–ù1 (–ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã min_temp)"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        below: "{{ states('input_number.min_temp')|float + 0.01 }}"
        # –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ <= min_temp (–¥–æ—Å—Ç–∏–≥–∞–µ—Ç –∏–ª–∏ –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ –º–∏–Ω–∏–º—É–º–∞)
    condition:
      # –í–∫–ª—é—á–∞–µ–º –¢–≠–ù1 —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –≤–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_1
        state: "off"
      # –ù–µ –≤–∫–ª—é—á–∞–µ–º –µ—Å–ª–∏ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–≠–ù2 (—á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ)
      - condition: state
        entity_id: switch.waveshare001_relay_2
        state: "off"
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.waveshare001_relay_1   # –¢–≠–ù1
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.ten1_start_time
          timestamp: "{{ now().timestamp() | int }}"
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.ten1_start_temp
          timestamp: "{{ states('sensor.waveshare001_rs485_temperature_10')|float }}"
      - service: script.send_notify
        data:
          message: "–¢–≠–ù1 –≤–∫–ª—é—á—ë–Ω. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C (–¥–æ—Å—Ç–∏–≥–ª–∞ –º–∏–Ω–∏–º—É–º–∞ {{ states('input_number.min_temp') }}¬∞C)."

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ü–æ–¥–æ–≥—Ä–µ–≤ ‚Äì –∫–æ–Ω—Ç—Ä–æ–ª—å –¢–≠–ù1 ‚Üí –¢–≠–ù2 (—á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç)"
    trigger:
      - platform: time_pattern
        minutes: "/1"   # –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
    condition:
      # –¢–≠–ù1 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_1
        state: "on"
      # –¢–≠–ù2 –µ—â–µ –Ω–µ –≤–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_2
        state: "off"
      # –ü—Ä–æ—à–ª–æ 5 –º–∏–Ω—É—Ç —Å –º–æ–º–µ–Ω—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –¢–≠–ù1
      - condition: template
        value_template: >-
          {{ (as_timestamp(now()) - as_timestamp(states.input_datetime.ten1_start_time.state)) / 60 >= 5 }}
      # –£—Å–ª–æ–≤–∏–µ: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ç–æ–∏—Ç (–Ω–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è) –∏–ª–∏ –ø–∞–¥–∞–µ—Ç
      # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –ø–æ–¥–Ω—è–ª–∞—Å—å –≤—ã—à–µ –Ω–∞—á–∞–ª—å–Ω–æ–π (—Å—Ç–æ–∏—Ç –∏–ª–∏ –ø–∞–¥–∞–µ—Ç)
      - condition: template
        value_template: >-
          {{ states('sensor.waveshare001_rs485_temperature_10')|float <= states.input_datetime.ten1_start_temp.state|float }}
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.waveshare001_relay_2   # –¢–≠–ù2
      - service: script.send_notify
        data:
          message: >-
            –¢–≠–ù2 –≤–∫–ª—é—á—ë–Ω. –ó–∞ 5 –º–∏–Ω—É—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –ø–æ–¥–Ω—è–ª–∞—Å—å (–±—ã–ª–æ {{ states.input_datetime.ten1_start_temp.state }}¬∞C, —Å–µ–π—á–∞—Å {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C). –û–±–∞ –¢–≠–ù–∞ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ {{ states('input_number.max_temp') }}¬∞C.

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ü–æ–¥–æ–≥—Ä–µ–≤ ‚Äì –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –¢–≠–ù1 (–ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ max_temp, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω)"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        above: input_number.max_temp
    condition:
      # –û—Ç–∫–ª—é—á–∞–µ–º –¢–≠–ù1 —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –≤–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_1
        state: "on"
      # –ò –¢–≠–ù2 –Ω–µ –≤–∫–ª—é—á–µ–Ω (–µ—Å–ª–∏ –¢–≠–ù2 –≤–∫–ª—é—á–µ–Ω, —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥—Ä—É–≥–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)
      - condition: state
        entity_id: switch.waveshare001_relay_2
        state: "off"
    action:
      # –û—Ç–∫–ª—é—á–∞–µ–º –¢–≠–ù1 –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ max_temp (–µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–¥–Ω–∏–º–∞–ª–∞—Å—å)
      - service: switch.turn_off
        target:
          entity_id: switch.waveshare001_relay_1   # –¢–≠–ù1
      - service: script.send_notify
        data:
          message: "–¢–≠–ù1 –æ—Ç–∫–ª—é—á–µ–Ω. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C (–º–∞–∫—Å–∏–º—É–º {{ states('input_number.max_temp') }}¬∞C)."

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ü–æ–¥–æ–≥—Ä–µ–≤ ‚Äì –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–±–æ–∏—Ö –¢–≠–ù–æ–≤ (–ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ max_temp)"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        above: input_number.max_temp
    condition:
      # –û—Ç–∫–ª—é—á–∞–µ–º –æ–±–∞ –¢–≠–ù–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–±–∞ –≤–∫–ª—é—á–µ–Ω—ã
      - condition: state
        entity_id: switch.waveshare001_relay_1
        state: "on"
      - condition: state
        entity_id: switch.waveshare001_relay_2
        state: "on"
    action:
      # –û—Ç–∫–ª—é—á–∞–µ–º –æ–±–∞ –¢–≠–ù–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ max_temp (–µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–±–∞)
      - service: switch.turn_off
        target:
          entity_id:
            - switch.waveshare001_relay_1   # –¢–≠–ù1
            - switch.waveshare001_relay_2   # –¢–≠–ù2
      - service: script.send_notify
        data:
          message: "–û–±–∞ –¢–≠–ù–∞ –æ—Ç–∫–ª—é—á–µ–Ω—ã. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C (–º–∞–∫—Å–∏–º—É–º {{ states('input_number.max_temp') }}¬∞C)."

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ò–ö ‚Äì –ø–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ 5-6"
    trigger:
      - platform: time
        at: "{{ states('input_datetime.ir_off_56') }}"
    action:
      - service: switch.turn_off
        target:
          entity_id: switch.waveshare001_relay_7
      - service: script.send_notify
        data:
          message: "–ò–ö –ª–∞–º–ø—ã 5-6 –≤—ã–∫–ª—é—á–µ–Ω—ã (–ø–ª–∞–Ω)."

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ò–ö ‚Äì –ø–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ 3-4"
    trigger:
      - platform: time
        at: "{{ states('input_datetime.ir_off_34') }}"
    action:
      - service: switch.turn_off
        target:
          entity_id: switch.waveshare001_relay_6
      - service: script.send_notify
        data:
          message: "–ò–ö –ª–∞–º–ø—ã 3-4 –≤—ã–∫–ª—é—á–µ–Ω—ã (–ø–ª–∞–Ω)."

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ò–ö ‚Äì –ø–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ 1-2"
    trigger:
      - platform: time
        at: "{{ states('input_datetime.ir_off_12') }}"
    action:
      - service: switch.turn_off
        target:
          entity_id: switch.waveshare001_relay_5
      - service: script.send_notify
        data:
          message: "–ò–ö –ª–∞–º–ø—ã 1-2 –≤—ã–∫–ª—é—á–µ–Ω—ã (–ø–ª–∞–Ω)."

  # -------------------------------------------------
  # 1.4 –û—Å–≤–µ—â–µ–Ω–∏–µ (–ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –≤—Å–µ—Ö –ò–ö)
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –û—Å–≤–µ—â–µ–Ω–∏–µ ‚Äì –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∏ –≤—Å–µ—Ö –ò–ö off"
    trigger:
      - platform: state
        entity_id: sensor.all_ir_off
        to: "true"
    condition:
      - condition: not
        conditions:
          - condition: state
            entity_id: input_text.brooder_state
            state: "–û–∂–∏–¥–∞–Ω–∏–µ"
    action:
      - service: input_text.set_value
        data:
          entity_id: input_text.brooder_state
          value: –û—Å–≤–µ—â–µ–Ω–∏–µ
      - service: switch.turn_on
        target:
          entity_id: switch.waveshare001_relay_8
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.lighting_start
          timestamp: "{{ now().timestamp() | int }}"
      - service: script.send_notify
        data:
          message: "–û—Å–≤–µ—â–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ (–≤—Å–µ –ò–ö –≤—ã–∫–ª—é—á–µ–Ω—ã)."

  # -------------------------------------------------
  # 1.5 –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –í–ï–ù–¢–ò–õ–Ø–¢–û–†–ê (–ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏, —Å –∑–∞—â–∏—Ç–æ–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã)
  # -------------------------------------------------
  
  # 1. –í–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø–æ –í–õ–ê–ñ–ù–û–°–¢–ò
  - alias: "[–ë—Ä—É–¥–µ—Ä] –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä ‚Äì –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_humidity_10
        above: input_number.max_hum
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        above: input_number.dehum_min_temp
    condition:
      # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤—ã–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_3
        state: "off"
      # –ü—Ä–æ—à–ª–æ –º–∏–Ω–∏–º—É–º 5 –º–∏–Ω—É—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (–ø–µ—Ä–∏–æ–¥ –ø–æ–∫–æ—è)
      - condition: or
        conditions:
          - condition: template
            value_template: "{{ states('input_datetime.fan_stop_time') == 'unknown' or states('input_datetime.fan_stop_time') == '' }}"
          - condition: template
            value_template: >-
              {{ (as_timestamp(now()) - as_timestamp(states.input_datetime.fan_stop_time.state)) / 60 >= 5 }}
      # –ù–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "–û–∂–∏–¥–∞–Ω–∏–µ"
      - condition: not
        conditions:
          - condition: state
            entity_id: input_text.brooder_state
            state: "–û–∂–∏–¥–∞–Ω–∏–µ"
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.waveshare001_relay_3   # –í–µ–Ω—Ç.—Å–∫–æ—Ä.1
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.fan_start_time
          timestamp: "{{ now().timestamp() | int }}"
      - service: input_text.set_value
        data:
          entity_id: input_text.fan_reason
          value: "humidity"
      - service: script.send_notify
        data:
          message: >-
            –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤–∫–ª—é—á—ë–Ω –ø–æ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏. –í–ª–∞–∂–Ω–æ—Å—Ç—å {{ states('sensor.waveshare001_rs485_humidity_10') }}%
            (–º–∞–∫—Å {{ states('input_number.max_hum') }}%), —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C.

  # 2. –í–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø–æ –¢–ï–ú–ü–ï–†–ê–¢–£–†–ï (–ø–µ—Ä–µ–≥—Ä–µ–≤)
  - alias: "[–ë—Ä—É–¥–µ—Ä] –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä ‚Äì –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ (–ø–µ—Ä–µ–≥—Ä–µ–≤)"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        above: input_number.max_temp
    condition:
      # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤—ã–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_3
        state: "off"
      # –ü—Ä–æ—à–ª–æ –º–∏–Ω–∏–º—É–º 5 –º–∏–Ω—É—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (–ø–µ—Ä–∏–æ–¥ –ø–æ–∫–æ—è)
      - condition: or
        conditions:
          - condition: template
            value_template: "{{ states('input_datetime.fan_stop_time') == 'unknown' or states('input_datetime.fan_stop_time') == '' }}"
          - condition: template
            value_template: >-
              {{ (as_timestamp(now()) - as_timestamp(states.input_datetime.fan_stop_time.state)) / 60 >= 5 }}
      # –ù–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "–û–∂–∏–¥–∞–Ω–∏–µ"
      - condition: not
        conditions:
          - condition: state
            entity_id: input_text.brooder_state
            state: "–û–∂–∏–¥–∞–Ω–∏–µ"
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.waveshare001_relay_3
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.fan_start_time
          timestamp: "{{ now().timestamp() | int }}"
      - service: input_text.set_value
        data:
          entity_id: input_text.fan_reason
          value: "temperature"
      - service: script.send_notify
        data:
          message: >-
            –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤–∫–ª—é—á—ë–Ω –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ (–ø–µ—Ä–µ–≥—Ä–µ–≤). –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C
            (–º–∞–∫—Å {{ states('input_number.max_temp') }}¬∞C).

  # 3. –†–∞–±–æ—Ç–∞ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
  - alias: "[–ë—Ä—É–¥–µ—Ä] –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä ‚Äì –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π —Ä–∞–±–æ—Ç—ã (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)"
    trigger:
      - platform: time_pattern
        minutes: "/1"
    condition:
      # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_3
        state: "on"
    action:
      - choose:
          # 3.1 –ï—Å–ª–∏ –ø—Ä–∏—á–∏–Ω–∞ = –í–õ–ê–ñ–ù–û–°–¢–¨
          - conditions:
              - condition: state
                entity_id: input_text.fan_reason
                state: "humidity"
              # –£—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ù–ï –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
              - condition: or
                conditions:
                  # –í–ª–∞–∂–Ω–æ—Å—Ç—å —É–ø–∞–ª–∞ –¥–æ min_hum –∏–ª–∏ –Ω–∏–∂–µ
                  - condition: template
                    value_template: >-
                      {{ states('sensor.waveshare001_rs485_humidity_10')|float <= states('input_number.min_hum')|float }}
                  # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —É–ø–∞–ª–∞ –¥–æ min_temp –∏–ª–∏ –Ω–∏–∂–µ
                  - condition: template
                    value_template: >-
                      {{ states('sensor.waveshare001_rs485_temperature_10')|float <= states('input_number.min_temp')|float }}
            sequence:
              - choose:
                  # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ: –≤–ª–∞–∂–Ω–æ—Å—Ç—å ‚â§ min_hum –ò –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã >= fan_min_on
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('sensor.waveshare001_rs485_humidity_10')|float <= states('input_number.min_hum')|float }}
                      - condition: template
                        value_template: >-
                          {{ (as_timestamp(now()) - as_timestamp(states.input_datetime.fan_start_time.state)) / 60 >= states('input_number.fan_min_on')|int }}
                    sequence:
                      - service: switch.turn_off
                        target:
                          entity_id: switch.waveshare001_relay_3
                      - service: input_datetime.set_datetime
                        data:
                          entity_id: input_datetime.fan_stop_time
                          timestamp: "{{ now().timestamp() | int }}"
                      - service: input_text.set_value
                        data:
                          entity_id: input_text.fan_reason
                          value: ""
                      - service: script.send_notify
                        data:
                          message: >-
                            –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –æ—Ç–∫–ª—é—á—ë–Ω (–≤–ª–∞–∂–Ω–æ—Å—Ç—å). –í–ª–∞–∂–Ω–æ—Å—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–ª–∞—Å—å –¥–æ {{ states('sensor.waveshare001_rs485_humidity_10') }}%
                            (–º–∏–Ω–∏–º—É–º {{ states('input_number.min_hum') }}%). –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {{ ((as_timestamp(now()) - as_timestamp(states.input_datetime.fan_start_time.state)) / 60)|int }} –º–∏–Ω.
          # 3.2 –ï—Å–ª–∏ –ø—Ä–∏—á–∏–Ω–∞ = –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê
          - conditions:
              - condition: state
                entity_id: input_text.fan_reason
                state: "temperature"
              # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —É–ø–∞–ª–∞ –¥–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤–æ–∑–≤—Ä–∞—Ç–∞ (max_temp - –≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å) –∏–ª–∏ –Ω–∏–∂–µ
              - condition: template
                value_template: >-
                  {{ states('sensor.waveshare001_rs485_temperature_10')|float <= (states('input_number.max_temp')|float - states('input_number.temp_fan_hysteresis')|float) }}
              # –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã >= fan_min_on
              - condition: template
                value_template: >-
                  {{ (as_timestamp(now()) - as_timestamp(states.input_datetime.fan_start_time.state)) / 60 >= states('input_number.fan_min_on')|int }}
            sequence:
              - service: switch.turn_off
                target:
                  entity_id: switch.waveshare001_relay_3
              - service: input_datetime.set_datetime
                data:
                  entity_id: input_datetime.fan_stop_time
                  timestamp: "{{ now().timestamp() | int }}"
              - service: input_text.set_value
                data:
                  entity_id: input_text.fan_reason
                  value: ""
              - service: script.send_notify
                data:
                  message: >-
                    –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –æ—Ç–∫–ª—é—á—ë–Ω (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞). –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–ª–∞—Å—å –¥–æ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C
                    (–ø–æ—Ä–æ–≥ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è {{ (states('input_number.max_temp')|float - states('input_number.temp_fan_hysteresis')|float)|round(1) }}¬∞C). –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {{ ((as_timestamp(now()) - as_timestamp(states.input_datetime.fan_start_time.state)) / 60)|int }} –º–∏–Ω.

  # 5. –ê–≤–∞—Ä–∏–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ1, –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤)
  - alias: "[–ë—Ä—É–¥–µ—Ä] –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä ‚Äì –∞–≤–∞—Ä–∏–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        below: "{{ states('input_number.min_temp')|float + 0.01 }}"
    condition:
      # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –≤–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: switch.waveshare001_relay_3
        state: "on"
    action:
      - service: switch.turn_off
        target:
          entity_id: switch.waveshare001_relay_3
      - service: input_datetime.set_datetime
        data:
          entity_id: input_datetime.fan_stop_time
          timestamp: "{{ now().timestamp() | int }}"
      - service: input_text.set_value
        data:
          entity_id: input_text.fan_reason
          value: ""
      - service: script.send_notify
        data:
          message: >-
            üö® –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –∞–≤–∞—Ä–∏–π–Ω–æ –æ—Ç–∫–ª—é—á—ë–Ω! –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —É–ø–∞–ª–∞ –¥–æ {{ states('sensor.waveshare001_rs485_temperature_10') }}¬∞C
            (–º–∏–Ω–∏–º—É–º {{ states('input_number.min_temp') }}¬∞C). –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –≤—Å–µ–º–∏ —Ä–µ–∂–∏–º–∞–º–∏).

  # 6. –°–≤—è–∑–∫–∞ —Å –¢–≠–ù–∞–º–∏ (–≤–∞–∂–Ω–æ)
  # –ï—Å–ª–∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å > max_hum, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ < dehum_min_temp, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –ù–ï –≤–∫–ª—é—á–∞–µ—Ç—Å—è
  # –¢–≠–ù—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ —Å–≤–æ–µ–π –ª–æ–≥–∏–∫–µ, –ø–æ–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è
  # –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è dehum_min_temp ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –≤–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –ø–æ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
  # –≠—Ç–∞ –ª–æ–≥–∏–∫–∞ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤–∫–ª—é—á–µ–Ω–∏—è –ø–æ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ (—É—Å–ª–æ–≤–∏–µ: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ >= dehum_min_temp)

  # -------------------------------------------------
  # 1.6 –û—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–∞–±–æ—á–∏–π —Ü–∏–∫–ª –∏–ª–∏ –∫–Ω–æ–ø–∫–∞)
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äì —Ä–∞–±–æ—á–∏–π —Ü–∏–∫–ª"
    trigger:
      - platform: time_pattern
        minutes: "/10"
    condition:
      - condition: template
        value_template: >-
          {{ (as_timestamp(now()) - as_timestamp(states.input_datetime.init_time.state)) / 86400
             > states('input_number.work_cycle')|int }}
      - condition: not
        conditions:
          - condition: state
            entity_id: input_text.brooder_state
            state: "–û–∂–∏–¥–∞–Ω–∏–µ"
    action:
      - service: script.stop_brooder

  - alias: "[–ë—Ä—É–¥–µ—Ä] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äì –∫–Ω–æ–ø–∫–∞ –°—Ç–æ–ø"
    trigger:
      - platform: state
        entity_id: input_button.stop_brooder
    action:
      - service: script.stop_brooder

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ –°—Ç–æ–ø (DI8)"
    trigger:
      - platform: state
        entity_id: binary_sensor.waveshare001_di8
        to: "on"
    action:
      - service: script.stop_brooder

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ –°—Ç–∞—Ä—Ç (DI7) ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å"
    trigger:
      - platform: state
        entity_id: binary_sensor.waveshare001_di7
        to: "on"
    action:
      - service: input_button.press
        target:
          entity_id: input_button.start_brooder

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ö–Ω–æ–ø–∫–∞ –ó–∞–ø—É—Å—Ç–∏—Ç—å ‚Üí –ü—Ä–æ–≥—Ä–µ–≤"
    trigger:
      - platform: state
        entity_id: input_button.start_brooder
    action:
      - service: input_button.press
        target:
          entity_id: input_button.preheat

# ======================================================================
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ì—Ä–∞—Ñ–∏–∫ –æ—Å–≤–µ—â–µ–Ω–∏—è (–ø–æ –ø—É–Ω–∫—Ç—É 1.5)
# ======================================================================
# –†–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º/–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è
# 24 —á —Å–≤–µ—Ç ‚Üí 22 —á ‚Üí 20 —á ‚Üí 18 —á ‚Üí 16 —á
# –ü—Ä–∏–º–µ—Ä (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ UI –∫–∞–∫ schedule):

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ì—Ä–∞—Ñ–∏–∫ –æ—Å–≤–µ—â–µ–Ω–∏—è ‚Äì –µ–∂–µ–¥–Ω–µ–≤–Ω–æ"
    trigger:
      - platform: time_pattern
        hours: "/24"
    condition:
      - condition: state
        entity_id: input_text.brooder_state
        state: "–û—Å–≤–µ—â–µ–Ω–∏–µ"
    action:
      - variables:
          day: >-
            {{ ((as_timestamp(now()) - as_timestamp(states.input_datetime.lighting_start.state)) / 86400) | int }}
          on_hours: >-
            {{ [24,22,20,18,16][ (day//2) if day < 10 else 4 ] }}
      - service: switch.turn_on
        target:
          entity_id: switch.waveshare001_relay_8
      - delay: "{{ '%02d:00:00'|format(on_hours) }}"
      - service: switch.turn_off
        target:
          entity_id: switch.waveshare001_relay_8


# ======================================================================
# –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–≤–∞—Ä–∏–π
# ======================================================================
  # -------------------------------------------------
  # 1. –ü–µ—Ä–µ–≥—Ä–µ–≤: T > max_temp + 3¬∞C
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ê–≤–∞—Ä–∏—è ‚Äì –ü–µ—Ä–µ–≥—Ä–µ–≤"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_temperature_10
        above: "{{ states('input_number.max_temp')|float + 3 }}"
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "off"
    action:
      - service: script.emergency_stop
        data:
          reason: "–ü–µ—Ä–µ–≥—Ä–µ–≤ (T > {{ states('input_number.max_temp')|float + 3 }}¬∞C)"

  # -------------------------------------------------
  # 2. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å: H > max_hum + 10%
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ê–≤–∞—Ä–∏—è ‚Äì –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å"
    trigger:
      - platform: numeric_state
        entity_id: sensor.waveshare001_rs485_humidity_10
        above: "{{ states('input_number.max_hum')|int + 10 }}"
    condition:
      - condition: state
        entity: input_boolean.emergency_active
        state: "off"
    action:
      - service: script.emergency_stop
        data:
          reason: "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å (H > {{ states('input_number.max_hum')|int + 10 }}%)"

  # -------------------------------------------------
  # 3. –î–∞—Ç—á–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã > 5 –º–∏–Ω—É—Ç
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ê–≤–∞—Ä–∏—è ‚Äì –î–∞—Ç—á–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"
    trigger:
      - platform: state
        entity_id: 
          - sensor.waveshare001_rs485_temperature_10
          - sensor.waveshare001_rs485_humidity_10
        to: "unavailable"
        for: "00:05:00"
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "off"
    action:
      - service: script.emergency_stop
        data:
          reason: "–î–∞—Ç—á–∏–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã >5 –º–∏–Ω"

  # -------------------------------------------------
  # 4. –ê–≤–∞—Ä–∏–π–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (DI8) ‚Üí –∞–≤–∞—Ä–∏–π–Ω—ã–π —Å—Ç–æ–ø
  # -------------------------------------------------
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ê–≤–∞—Ä–∏—è ‚Äì –ö–Ω–æ–ø–∫–∞ DI8"
    trigger:
      - platform: state
        entity_id: binary_sensor.waveshare001_di8
        to: "on"
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "off"
    action:
      - service: script.emergency_stop
        data:
          reason: "–ù–∞–∂–∞—Ç–∞ –∞–≤–∞—Ä–∏–π–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (DI8)"


# ======================================================================
# –°–ë–†–û–° –ê–í–ê–†–ò–ò (—Ä—É—á–Ω–æ–π)
# ======================================================================
  - alias: "[–ë—Ä—É–¥–µ—Ä] –°–±—Ä–æ—Å –∞–≤–∞—Ä–∏–∏"
    trigger:
      - platform: state
        entity_id: input_button.reset_emergency
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "on"
    action:
      - service: input_boolean.turn_off
        target:
          entity_id: input_boolean.emergency_active
      - service: input_text.set_value
        data:
          entity_id: input_text.brooder_state
          value: –û–∂–∏–¥–∞–Ω–∏–µ
      - service: input_text.set_value
        data:
          entity_id: input_text.emergency_reason
          value: ""
      - service: notify.brooder_notify
        data:
          message: >-
            ‚úÖ –ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º —Å–±—Ä–æ—à–µ–Ω. –ë—Ä—É–¥–µ—Ä –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "–û–∂–∏–¥–∞–Ω–∏–µ".
            –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ü–∏–∫–ª.

# ======================================================================
# –ë–õ–û–ö–ò–†–û–í–ö–ê –ó–ê–ü–£–°–ö–ê –ü–†–ò –ê–í–ê–†–ò–ò
# ======================================================================
# –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª–æ–≤–∏–µ –≤–æ –í–°–ï –∫–Ω–æ–ø–∫–∏ –∑–∞–ø—É—Å–∫–∞:
  - alias: "[–ë—Ä—É–¥–µ—Ä] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∞–≤–∞—Ä–∏–∏ ‚Äì –ü—Ä–æ–≥—Ä–µ–≤"
    trigger:
      - platform: state
        entity_id: input_button.preheat
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "on"
    action:
      - service: notify.brooder_notify
        data:
          message: >-
            ‚ö†Ô∏è –ó–∞–ø—É—Å–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –∞–∫—Ç–∏–≤–µ–Ω –∞–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º.
            –ù–∞–∂–º–∏—Ç–µ "–°–±—Ä–æ—Å –∞–≤–∞—Ä–∏–∏" –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã.

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∞–≤–∞—Ä–∏–∏ ‚Äì –ó–∞–ø—É—Å—Ç–∏—Ç—å"
    trigger:
      - platform: state
        entity_id: input_button.start_brooder
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "on"
    action:
      - service: notify.brooder_notify
        data:
          message: >-
            ‚ö†Ô∏è –ó–∞–ø—É—Å–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –∞–∫—Ç–∏–≤–µ–Ω –∞–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º.

  - alias: "[–ë—Ä—É–¥–µ—Ä] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–Ω–æ–ø–∫–∏ DI7 –ø—Ä–∏ –∞–≤–∞—Ä–∏–∏"
    trigger:
      - platform: state
        entity_id: binary_sensor.waveshare001_di7
        to: "on"
    condition:
      - condition: state
        entity_id: input_boolean.emergency_active
        state: "on"
    action:
      - service: notify.brooder_notify
        data:
          message: >-
            ‚ö†Ô∏è –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞ (DI7) –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞: –∞–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω.          
